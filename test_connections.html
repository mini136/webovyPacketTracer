<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test připojení portů</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .device {
            position: relative;
            width: 150px;
            height: 150px;
            background: white;
            border: 2px solid #2563eb;
            border-radius: 8px;
            margin: 50px;
            display: inline-block;
            vertical-align: top;
        }
        .port {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #2563eb;
            border: 1.5px solid white;
            border-radius: 50%;
            cursor: crosshair;
        }
        .port-target {
            position: absolute;
            width: 16px;
            height: 16px;
            background: rgba(255, 0, 0, 0.2);
            border: 1px dashed red;
            border-radius: 50%;
            cursor: crosshair;
            transform: translate(-50%, -50%);
        }
        .port.left {
            left: 0;
            transform: translateX(-50%);
        }
        .port.right {
            right: 0;
            transform: translateX(50%);
        }
        .label {
            position: absolute;
            font-size: 10px;
            background: white;
            padding: 2px 4px;
            border: 1px solid #2563eb;
            border-radius: 3px;
            white-space: nowrap;
        }
        .label.left {
            left: -50px;
        }
        .label.right {
            right: -50px;
        }
        .device-label {
            text-align: center;
            padding-top: 60px;
            font-weight: bold;
        }
        .info {
            margin: 20px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border: 2px solid #059669;
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
        }
        .success {
            background: #d1fae5;
            border: 1px solid #059669;
        }
        .error {
            background: #fee2e2;
            border: 1px solid #dc2626;
        }
    </style>
</head>
<body>
    <h1>Test připojení portů - Router a Switch</h1>
    
    <div class="info">
        <h3>Testovací scénář:</h3>
        <p><strong>Router (4 porty):</strong> 2 vlevo (15%, 30%), 2 vpravo (15%, 30%)</p>
        <p><strong>Switch (8 portů):</strong> 4 vlevo, 4 vpravo - rovnoměrně</p>
        <p><strong>Červené kruhy</strong> = target area (16px) - sem se má dát napojit kabel</p>
    </div>

    <div id="devices"></div>

    <div class="info">
        <h3>Výsledky testů:</h3>
        <div id="results"></div>
    </div>

    <script>
        // Výpočet pozic portů
        function calculatePortPositions(deviceType, portCount) {
            const ports = [];
            
            if (deviceType === 'router') {
                // Router: 4 porty, každý 15% od rohu
                for (let i = 0; i < portCount; i++) {
                    if (i < 2) {
                        ports.push({
                            side: 'left',
                            offset: 15 + (i * 15),
                            name: `Gig0/${i}`
                        });
                    } else {
                        ports.push({
                            side: 'right',
                            offset: 15 + ((i - 2) * 15),
                            name: `Gig0/${i}`
                        });
                    }
                }
            } else if (deviceType === 'switch') {
                // Switch: rovnoměrné rozmístění
                const leftPorts = Math.ceil(portCount / 2);
                const rightPorts = portCount - leftPorts;
                
                for (let i = 0; i < portCount; i++) {
                    if (i < leftPorts) {
                        ports.push({
                            side: 'left',
                            offset: ((i + 1) / (leftPorts + 1)) * 100,
                            name: `Fa0/${i + 1}`
                        });
                    } else {
                        const rightIndex = i - leftPorts;
                        ports.push({
                            side: 'right',
                            offset: ((rightIndex + 1) / (rightPorts + 1)) * 100,
                            name: `Fa0/${i + 1}`
                        });
                    }
                }
            }
            
            return ports;
        }

        // Vykreslení zařízení
        function renderDevice(deviceType, portCount, containerId) {
            const container = document.getElementById(containerId);
            const device = document.createElement('div');
            device.className = 'device';
            
            const label = document.createElement('div');
            label.className = 'device-label';
            label.textContent = deviceType.toUpperCase();
            device.appendChild(label);
            
            const ports = calculatePortPositions(deviceType, portCount);
            
            ports.forEach((port, index) => {
                // Source port (viditelný)
                const portEl = document.createElement('div');
                portEl.className = `port ${port.side}`;
                portEl.style.top = `${port.offset}%`;
                portEl.dataset.portId = `port-${index}`;
                portEl.dataset.side = port.side;
                portEl.dataset.offset = port.offset;
                device.appendChild(portEl);
                
                // Target port (průhledný, větší)
                const targetEl = document.createElement('div');
                targetEl.className = `port-target ${port.side}`;
                targetEl.style.top = `${port.offset}%`;
                targetEl.dataset.portId = `port-${index}-in`;
                targetEl.dataset.side = port.side;
                targetEl.dataset.offset = port.offset;
                device.appendChild(targetEl);
                
                // Label
                const labelEl = document.createElement('div');
                labelEl.className = `label ${port.side}`;
                labelEl.style.top = `${port.offset}%`;
                labelEl.style.transform = 'translateY(-50%)';
                labelEl.textContent = port.name;
                device.appendChild(labelEl);
            });
            
            container.appendChild(device);
            return ports;
        }

        // Spuštění testů
        function runTests() {
            const devicesContainer = document.getElementById('devices');
            const resultsContainer = document.getElementById('results');
            
            // Vykreslení routeru a switche
            const routerPorts = renderDevice('router', 4, 'devices');
            const switchPorts = renderDevice('switch', 8, 'devices');
            
            // Test 1: Kontrola počtu portů
            addResult(resultsContainer, 
                routerPorts.length === 4 && switchPorts.length === 8,
                `Počet portů: Router má ${routerPorts.length} portů, Switch má ${switchPorts.length} portů`
            );
            
            // Test 2: Kontrola pozic routeru
            const routerLeftPorts = routerPorts.filter(p => p.side === 'left');
            const routerRightPorts = routerPorts.filter(p => p.side === 'right');
            addResult(resultsContainer,
                routerLeftPorts.length === 2 && routerRightPorts.length === 2,
                `Router distribuce: ${routerLeftPorts.length} vlevo, ${routerRightPorts.length} vpravo`
            );
            
            // Test 3: Kontrola offsetů routeru
            const routerOffsetsCorrect = 
                routerLeftPorts[0].offset === 15 &&
                routerLeftPorts[1].offset === 30 &&
                routerRightPorts[0].offset === 15 &&
                routerRightPorts[1].offset === 30;
            addResult(resultsContainer,
                routerOffsetsCorrect,
                `Router offsety: Vlevo [${routerLeftPorts.map(p => p.offset).join(', ')}%], Vpravo [${routerRightPorts.map(p => p.offset).join(', ')}%]`
            );
            
            // Test 4: Kontrola pozic switche
            const switchLeftPorts = switchPorts.filter(p => p.side === 'left');
            const switchRightPorts = switchPorts.filter(p => p.side === 'right');
            addResult(resultsContainer,
                switchLeftPorts.length === 4 && switchRightPorts.length === 4,
                `Switch distribuce: ${switchLeftPorts.length} vlevo, ${switchRightPorts.length} vpravo`
            );
            
            // Test 5: Kontrola rovnoměrného rozmístění switche
            const switchLeftOffsets = switchLeftPorts.map(p => p.offset);
            const switchRightOffsets = switchRightPorts.map(p => p.offset);
            addResult(resultsContainer,
                true,
                `Switch offsety: Vlevo [${switchLeftOffsets.map(o => o.toFixed(1)).join(', ')}%], Vpravo [${switchRightOffsets.map(o => o.toFixed(1)).join(', ')}%]`
            );
            
            // Test 6: Kontrola že žádné porty se nepřekrývají
            function checkOverlap(ports) {
                const leftOffsets = ports.filter(p => p.side === 'left').map(p => p.offset);
                const rightOffsets = ports.filter(p => p.side === 'right').map(p => p.offset);
                const leftUnique = new Set(leftOffsets).size === leftOffsets.length;
                const rightUnique = new Set(rightOffsets).size === rightOffsets.length;
                return leftUnique && rightUnique;
            }
            
            addResult(resultsContainer,
                checkOverlap(routerPorts) && checkOverlap(switchPorts),
                'Žádné porty se nepřekrývají'
            );
            
            // Test 7: Vizuální informace o target area
            addResult(resultsContainer,
                true,
                'Target area (červené kruhy) mají velikost 16px pro snadnější připojení kabelů'
            );
        }

        function addResult(container, success, message) {
            const div = document.createElement('div');
            div.className = `test-result ${success ? 'success' : 'error'}`;
            div.textContent = `${success ? '✅' : '❌'} ${message}`;
            container.appendChild(div);
        }

        // Spustit testy po načtení
        runTests();
    </script>
</body>
</html>
